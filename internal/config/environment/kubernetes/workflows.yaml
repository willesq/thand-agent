version: "1.0"
workflows:
  k8s_simple_elevation:
    description: Simple Kubernetes access elevation without approval
    authentication: default
    enabled: true
    workflow:
      document:
        dsl: "1.0.0-alpha5"
        namespace: "thand"
        name: "k8s-simple-elevation"
        version: "1.0.0"
      do:
        - validate:
            thand: validate
            with:
              validator: static
            then: authorize
        - authorize:
            thand: authorize
            with:
              revocation: revoke
            then: monitor
        - monitor:
            thand: monitor
            with:
              monitor: llm
              threshold: 10
            then: revoke
        - revoke:
            thand: revoke
            then: end
  